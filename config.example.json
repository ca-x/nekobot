{
  "_comment": "=== NekoBot 配置文件示例 ===",
  "_description": {
    "配置加载优先级": [
      "1. 命令行参数 (最高优先级)",
      "2. 环境变量 (NEKOBOT_前缀, 如 NEKOBOT_AGENTS_DEFAULTS_PROVIDER)",
      "3. ~/.nekobot/config.json (用户配置)",
      "4. /etc/nekobot/config.json (系统配置)",
      "5. 代码默认值 (最低优先级)"
    ],
    "自动故障转移": "配置 fallback 数组后,主 provider 失败时会自动尝试备用 provider",
    "断路器保护": "连续 5 次失败后自动切换到下一个 provider, 5 分钟后重试"
  },

  "agents": {
    "defaults": {
      "workspace": "~/.nekobot/workspace",
      "provider": "anthropic",
      "fallback": ["openai", "ollama"],
      "model": "claude-3-5-sonnet-20241022",
      "max_tokens": 4096,
      "temperature": 0.7,
      "max_tool_iterations": 10,
      "_note": "fallback 是可选的,指定备用 provider 列表实现自动故障转移"
    }
  },

  "providers": {
    "_comment": "所有 provider 都只需配置 api_key 和 api_base 两个字段",

    "anthropic": {
      "api_key": "",
      "api_base": "https://api.anthropic.com",
      "_models": ["claude-3-5-sonnet-20241022", "claude-3-opus-20240229", "claude-3-haiku-20240307"]
    },
    "openai": {
      "api_key": "",
      "api_base": "https://api.openai.com/v1",
      "_models": ["gpt-4-turbo", "gpt-4", "gpt-3.5-turbo"]
    },
    "google": {
      "api_key": "",
      "api_base": "https://generativelanguage.googleapis.com",
      "_models": ["gemini-pro", "gemini-pro-vision"]
    },
    "openrouter": {
      "api_key": "",
      "api_base": "https://openrouter.ai/api/v1",
      "_description": "OpenRouter - 通过统一 API 访问多个模型",
      "_models": ["anthropic/claude-3.5-sonnet", "openai/gpt-4-turbo", "google/gemini-pro"]
    },
    "deepseek": {
      "api_key": "",
      "api_base": "https://api.deepseek.com/v1",
      "_description": "DeepSeek - 高性价比的国产大模型",
      "_models": ["deepseek-chat", "deepseek-coder"]
    },
    "together": {
      "api_key": "",
      "api_base": "https://api.together.xyz/v1",
      "_description": "Together AI - OpenAI 兼容 API",
      "_models": ["meta-llama/Llama-3-70b-chat-hf", "mistralai/Mixtral-8x7B-Instruct-v0.1"]
    },
    "groq": {
      "api_key": "",
      "api_base": "https://api.groq.com/openai/v1",
      "_description": "Groq - 超快 LLM 推理速度",
      "_models": ["llama-3.1-70b-versatile", "mixtral-8x7b-32768"]
    },
    "ollama": {
      "api_key": "ollama",
      "api_base": "http://localhost:11434/v1",
      "_description": "Ollama - 本地部署模型 (需先安装 Ollama)",
      "_models": ["llama3:70b", "llama3:8b", "mistral", "codellama", "qwen2"]
    },
    "lmstudio": {
      "api_key": "lm-studio",
      "api_base": "http://localhost:1234/v1",
      "_description": "LM Studio - 本地 GUI 模型管理",
      "_note": "在 LM Studio 中下载模型并启动 API 服务器"
    },
    "vllm": {
      "api_key": "vllm",
      "api_base": "http://localhost:8000/v1",
      "_description": "vLLM - 高性能自建推理服务",
      "_note": "需自行部署 vLLM 服务: python -m vllm.entrypoints.openai.api_server --model <model-name>"
    },
    "custom": {
      "api_key": "your-api-key",
      "api_base": "https://your-custom-api.com/v1",
      "_description": "自定义端点 - 任何 OpenAI 兼容的 API 都可以使用",
      "_note": "需要实现 OpenAI 的 /v1/chat/completions 接口"
    }
  },

  "gateway": {
    "host": "0.0.0.0",
    "port": 8080,
    "_note": "Gateway 模式: nekobot gateway"
  },

  "channels": {
    "_comment": "多渠道接入配置 - 在 gateway 模式下使用",

    "telegram": {
      "enabled": false,
      "bot_token": "",
      "allow_from": [],
      "proxy": "",
      "_note": "从 @BotFather 获取 bot_token"
    },
    "discord": {
      "enabled": false,
      "bot_token": "",
      "allow_from": [],
      "proxy": "",
      "_note": "从 Discord Developer Portal 创建 bot"
    },
    "slack": {
      "enabled": false,
      "bot_token": "",
      "app_token": "",
      "allow_from": [],
      "_note": "需要 Bot Token 和 App Token (Socket Mode)"
    },
    "whatsapp": {
      "enabled": false,
      "bridge_url": "ws://localhost:3000",
      "allow_from": [],
      "_note": "需要部署 WhatsApp Bridge 服务"
    },
    "feishu": {
      "enabled": false,
      "app_id": "",
      "app_secret": "",
      "encrypt_key": "",
      "verification_token": "",
      "allow_from": [],
      "_note": "飞书开放平台创建应用"
    },
    "dingtalk": {
      "enabled": false,
      "client_id": "",
      "client_secret": "",
      "allow_from": [],
      "_note": "钉钉开放平台创建应用"
    },
    "qq": {
      "enabled": false,
      "app_id": "",
      "app_secret": "",
      "allow_from": [],
      "_note": "QQ 机器人开放平台"
    },
    "maixcam": {
      "enabled": false,
      "host": "0.0.0.0",
      "port": 8765,
      "allow_from": [],
      "_note": "MaixCAM 设备接入"
    },
    "serverchan": {
      "enabled": false,
      "bot_token": "",
      "allow_from": [],
      "_note": "Server酱推送服务"
    },
    "wework": {
      "enabled": false,
      "corp_id": "",
      "agent_id": "",
      "corp_secret": "",
      "token": "",
      "encoding_aes_key": "",
      "allow_from": [],
      "_note": "企业微信应用"
    },
    "googlechat": {
      "enabled": false,
      "project_id": "",
      "credentials_file": "",
      "allow_from": [],
      "_note": "Google Chat Bot (需要 Service Account)"
    }
  },

  "tools": {
    "_comment": "Agent 可用的工具配置",

    "exec": {
      "enabled": true,
      "allow_commands": ["ls", "cat", "grep", "find", "git"],
      "timeout": 30,
      "_note": "支持三种模式: 标准、PTY (pty:true)、后台 (background:true)"
    },
    "web_search": {
      "enabled": true,
      "brave_api_key": "",
      "_note": "从 https://brave.com/search/api/ 获取 API key"
    },
    "web_fetch": {
      "enabled": true,
      "timeout": 30,
      "_note": "抓取网页内容"
    },
    "file_operations": {
      "enabled": true,
      "max_file_size": 10485760,
      "_note": "文件操作: read_file, write_file, list_dir, edit_file, append_file"
    }
  },

  "heartbeat": {
    "enabled": false,
    "interval_minutes": 60,
    "_note": "自主任务执行 - 从 HEARTBEAT.md 读取提示词定期执行"
  },

  "memory": {
    "_comment": "长期记忆系统 (可选)",

    "qmd": {
      "enabled": false,
      "command": "qmd",
      "include_default": true,
      "paths": [
        {
          "name": "docs",
          "path": "~/Documents",
          "pattern": "**/*.md"
        }
      ],
      "sessions": {
        "enabled": true,
        "export_dir": "${WORKSPACE}/memory/sessions",
        "retention_days": 90
      },
      "update": {
        "on_boot": true,
        "interval": "30m",
        "command_timeout": "30s",
        "update_timeout": "5m"
      },
      "_note": "需要安装 qmd: https://github.com/polyverse-app/qmd"
    }
  },

  "skills": {
    "auto_reload": true,
    "builtin_enabled": true,
    "_note": "Skills 加载路径: ~/.nekobot/skills/ 和内置 skills/"
  },

  "_examples": {
    "_comment": "=== 常见配置示例 ===",

    "示例 1 - 最简单配置": {
      "agents": {
        "defaults": {
          "provider": "anthropic",
          "model": "claude-3-5-sonnet-20241022"
        }
      },
      "providers": {
        "anthropic": {
          "api_key": "your-api-key",
          "api_base": "https://api.anthropic.com"
        }
      }
    },

    "示例 2 - 云端主力 + 本地备份": {
      "agents": {
        "defaults": {
          "provider": "anthropic",
          "fallback": ["openai", "ollama"],
          "model": "claude-3-5-sonnet-20241022"
        }
      }
    },

    "示例 3 - 本地优先节省成本": {
      "agents": {
        "defaults": {
          "provider": "ollama",
          "fallback": ["openai"],
          "model": "llama3:70b"
        }
      }
    },

    "示例 4 - 环境变量配置": {
      "_bash": [
        "export NEKOBOT_AGENTS_DEFAULTS_PROVIDER=anthropic",
        "export NEKOBOT_AGENTS_DEFAULTS_MODEL=claude-3-5-sonnet-20241022",
        "export NEKOBOT_PROVIDERS_ANTHROPIC_API_KEY=your-key",
        "nekobot agent"
      ]
    }
  }
}

import{c as h,r as m,b as k,t as o,j as e}from"./index-DMfSApuS.js";import{H,B as f}from"./button-DVjcoFYi.js";import{I as w}from"./input-BjWckbrv.js";import{L as j}from"./label-CM1ch2aQ.js";import{S as D}from"./switch-CMS6Rz8H.js";import{S as T,a as V,b as q,c as B,d as U}from"./select-CfAm6h5s.js";import{S as G}from"./scroll-area-KV2hHBLE.js";import{u as P,a as $,b as K,c as W}from"./useConfig-DNdO4wws.js";import{S as _}from"./save-hZIBG70c.js";import"./Combination-BtX0Jl8h.js";import"./useMutation-TaRjHYf5.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Q=h("Code",[["polyline",{points:"16 18 22 12 16 6",key:"z7tu5w"}],["polyline",{points:"8 6 2 12 8 18",key:"1eg1df"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const X=h("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Y=h("RectangleEllipsis",[["rect",{width:"20",height:"12",x:"2",y:"6",rx:"2",key:"9lu3g6"}],["path",{d:"M12 12h.01",key:"1mp3jc"}],["path",{d:"M17 12h.01",key:"1m0b6t"}],["path",{d:"M7 12h.01",key:"eqddd0"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Z=h("RotateCcw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ee=h("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]),te=["agents","gateway","tools","memory","heartbeat","approval","logger","webui"];function O(t){return{agents:o("configSectionAgents"),gateway:o("configSectionGateway"),tools:o("configSectionTools"),memory:o("configSectionMemory"),heartbeat:o("configSectionHeartbeat"),approval:o("configSectionApproval"),logger:o("configSectionLogger"),webui:o("configSectionWebUI")}[t]||t}function A(t,i=""){const s={};if(!t||typeof t!="object"||Array.isArray(t))return s;for(const n of Object.keys(t)){const r=i?`${i}.${n}`:n,l=t[n];l!==null&&typeof l=="object"&&!Array.isArray(l)?Object.assign(s,A(l,r)):s[r]=l}return s}function se(t,i,s){const n=i.split(".");let r=t;for(let l=0;l<n.length-1;l++)(!r[n[l]]||typeof r[n[l]]!="object")&&(r[n[l]]={}),r=r[n[l]];r[n[n.length-1]]=s}function ae(t){const i=A(t);return Object.entries(i).map(([s,n])=>{let r="text";return typeof n=="boolean"?r="bool":typeof n=="number"?r="number":Array.isArray(n)&&(r="tags"),{key:s,type:r,value:n}})}function ne({field:t,onChange:i}){switch(t.type){case"bool":return e.jsxs("div",{className:"flex items-center justify-between py-2.5 px-1 border-b border-border/50",children:[e.jsx(j,{className:"text-sm font-mono text-muted-foreground",children:t.key}),e.jsx(D,{checked:!!t.value,onCheckedChange:s=>i(t.key,s)})]});case"number":return e.jsxs("div",{className:"flex items-center justify-between gap-4 py-2.5 px-1 border-b border-border/50",children:[e.jsx(j,{className:"text-sm font-mono text-muted-foreground shrink-0",children:t.key}),e.jsx(w,{type:"number",className:"w-32 text-right",value:t.value!=null?String(t.value):"",onChange:s=>i(t.key,s.target.value===""?0:Number(s.target.value))})]});case"tags":return e.jsxs("div",{className:"py-2.5 px-1 border-b border-border/50",children:[e.jsx(j,{className:"text-sm font-mono text-muted-foreground block mb-1.5",children:t.key}),e.jsx("textarea",{className:"w-full rounded-md border border-input bg-background px-3 py-2 text-sm font-mono resize-y min-h-[60px]",rows:2,value:Array.isArray(t.value)?t.value.join(`
`):String(t.value??""),onChange:s=>i(t.key,s.target.value.split(`
`).map(n=>n.trim()).filter(Boolean))})]});default:return e.jsxs("div",{className:"flex items-center justify-between gap-4 py-2.5 px-1 border-b border-border/50",children:[e.jsx(j,{className:"text-sm font-mono text-muted-foreground shrink-0",children:t.key}),e.jsx(w,{className:"max-w-xs",value:t.value!=null?String(t.value):"",onChange:s=>i(t.key,s.target.value)})]})}}function fe(){const[t,i]=m.useState("agents"),[s,n]=m.useState("form"),[r,l]=m.useState("{}"),[d,p]=m.useState(null),S=m.useRef(null),{data:c,isLoading:M}=P(),v=$(),F=K(),N=W(),x=d??(c==null?void 0:c[t])??{},C=ae(x),J=m.useCallback(a=>{i(a),p(null),n("form")},[]),I=m.useCallback((a,u)=>{p(g=>{const y=g??{...(c==null?void 0:c[t])??{}},b=JSON.parse(JSON.stringify(y));return se(b,a,u),b})},[c,t]),L=m.useCallback(()=>{if(s==="form")l(JSON.stringify(d??x,null,2)),n("json");else{try{const a=JSON.parse(r);p(a)}catch(a){k.error(o("invalidJson",String(a)));return}n("form")}},[s,d,x,r]),R=m.useCallback(()=>{let a;if(s==="json")try{a=JSON.parse(r)}catch(u){k.error(o("invalidJson",String(u)));return}else a=d??x;v.mutate({[t]:a}),p(null)},[s,r,d,x,t,v]),z=m.useCallback(()=>{p(null),s==="json"&&l(JSON.stringify((c==null?void 0:c[t])??{},null,2))},[c,t,s]),E=m.useCallback(a=>{var y;const u=(y=a.target.files)==null?void 0:y[0];if(!u)return;const g=new FileReader;g.onload=()=>{try{const b=JSON.parse(g.result);N.mutate(b)}catch{k.error(o("importFailed"))}},g.readAsText(u),a.target.value=""},[N]);return e.jsxs("div",{className:"flex flex-col h-full",children:[e.jsx(H,{title:o("tabConfig")}),e.jsxs("div",{className:"flex items-center gap-2 px-6 pb-4 flex-wrap",children:[e.jsxs(T,{value:t,onValueChange:J,children:[e.jsx(V,{className:"w-[180px]",children:e.jsx(q,{})}),e.jsx(B,{children:te.map(a=>e.jsx(U,{value:a,children:O(a)},a))})]}),e.jsx(f,{variant:"outline",size:"sm",onClick:L,children:s==="form"?e.jsxs(e.Fragment,{children:[e.jsx(Q,{className:"h-4 w-4 mr-1"}),o("configJsonMode")]}):e.jsxs(e.Fragment,{children:[e.jsx(Y,{className:"h-4 w-4 mr-1"}),o("configFormMode")]})}),e.jsx("div",{className:"flex-1"}),e.jsxs(f,{variant:"outline",size:"sm",onClick:z,children:[e.jsx(Z,{className:"h-4 w-4 mr-1"}),o("reset")]}),e.jsxs(f,{size:"sm",onClick:R,disabled:v.isPending,children:[e.jsx(_,{className:"h-4 w-4 mr-1"}),o("save")]}),e.jsxs(f,{variant:"outline",size:"sm",onClick:()=>F.mutate(),children:[e.jsx(X,{className:"h-4 w-4 mr-1"}),o("exportConfig")]}),e.jsxs(f,{variant:"outline",size:"sm",onClick:()=>{var a;return(a=S.current)==null?void 0:a.click()},children:[e.jsx(ee,{className:"h-4 w-4 mr-1"}),o("importConfig")]}),e.jsx("input",{ref:S,type:"file",accept:".json",className:"hidden",onChange:E})]}),e.jsx("p",{className:"px-6 pb-3 text-sm text-muted-foreground",children:o("configSectionHint",O(t))}),e.jsx(G,{className:"flex-1 px-6 pb-6",children:M?e.jsx("div",{className:"text-muted-foreground py-8 text-center animate-pulse",children:"Loading\\u2026"}):s==="form"?e.jsx("div",{className:"max-w-2xl",children:C.length===0?e.jsx("div",{className:"text-muted-foreground py-8 text-center text-sm",children:"No configuration fields in this section."}):C.map(a=>e.jsx(ne,{field:a,onChange:I},a.key))}):e.jsx("textarea",{className:"w-full h-[60vh] rounded-md border border-input bg-background px-4 py-3 text-sm font-mono resize-y",value:r,onChange:a=>l(a.target.value),spellCheck:!1})})]})}export{fe as default};
